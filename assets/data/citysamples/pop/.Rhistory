library(tidyverse)
tract <- read_csv("tracts.csv")
bgr <- read_csv("population_by_block_group_by_race_2012_to_2016_with_lat_lng.csv")
bgr
bgr %>% mutate(tractid = str_sub(2, 12))
wideScreen()
bgr %>% mutate(tractid = str_sub(2, 12))
bgr %>% mutate(tractid = str_sub(gis_block_group_id, 2, 12))
bgr %>% mutate(tractid = str_sub(gis_block_group_id, 2, 12)) %>% right_join(tract)
bgr %>% mutate(tractid = str_sub(gis_block_group_id, 2, 12)) %>% right_join(tract) %>%> print(n=100)
bgr %>% mutate(tractid = str_sub(gis_block_group_id, 2, 12)) %>% right_join(tract) %>% print(n=100)
bgr 
bgr %>% select(gis_block_group_id) %>% print(n=100)
bgr
bgr %>% filter(state == "Arizona")
bgr %>% mutate(tractid = str_sub(gis_block_group_id, 2, 12))
bgr 
bgr %>% filter(state == "Alabama")
bgr %>% filter(state == "Arizona")
bgr %>% filter(state == "Kansas")
bgr %>% filter(state == "Wisconsin")
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 4))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 4, 6))
bgr %>% count(str_sub(2, 2))
bgr %>% count(str_sub(2, 3))
bgr %>% count(str_sub(gis_block_group_id, 2, 3))
bgr %>% count(str_sub(gis_block_group_id, 2, 2))
bgr %>% count(str_sub(gis_block_group_id, 3, 3))
bgr %>% count(str_sub(gis_block_group_id, 4, ))
bgr %>% count(str_sub(gis_block_group_id, 4, 4))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 4, 6))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 6))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7))
bgr %>% count(str_sub(gis_block_group_id, 8, 8))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7), tractid = str_sub(gis_block_group_id, 9, 14))
bgr %>% count(str_sub(gis_block_group_id, 15, 15))
bgr %>% count(str_sub(gis_block_group_id, 16, 16))
bgr %>% count(str_sub(gis_block_group_id, 14, 14))
bgr %>% count(str_sub(gis_block_group_id, 13, 13))
bgr %>% count(str_sub(gis_block_group_id, 12, 1))
bgr %>% count(str_sub(gis_block_group_id, 12, 12))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7), tractid = str_sub(gis_block_group_id, 9, 14))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7), stid = str_sub(gis_block_group_id, 9, 14), tractid=str_c(stateid, countyid, stid))
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7), stid = str_sub(gis_block_group_id, 9, 14), tractid=str_c(stateid, countyid, stid)) %>% right_join(tract)
bgr %>% mutate(tract_id = str_c(
  str_sub(gis_block_group_id, 2, 3),
  str_sub(gis_block_group_id, 5, 7),
  str_sub(gis_block_group_id, 9, 14)
))
join <- bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7), tractid = str_sub(gis_block_group_id,str_c(stateid, countyid, stid)) %>% right_join(tract)
)
bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7), stid = str_sub(gis_block_group_id, 9, 14), tractid=str_c(stateid, countyid, stid)) %>% right_join(tract)
joined <- bgr %>% mutate(stateid = str_sub(gis_block_group_id, 2, 3), countyid = str_sub(gis_block_group_id, 5, 7), stid = str_sub(gis_block_group_id, 9, 14), tractid=str_c(stateid, countyid, stid)) %>% right_join(tract)
write_csv(joined, "joined.csv")
joined %>% count(slug)
